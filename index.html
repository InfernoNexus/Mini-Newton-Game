<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Newton's Gravity Enhanced</title>
<style>
body {
  margin: 0;
  text-align: center;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(#b3e5fc, #e1f5fe);
  overflow: hidden;
}
canvas {
  display: block;
  margin: 20px auto;
  background: #87ceeb;
  border: 5px solid #2e7d32;
  border-radius: 40px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}
#controls {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 10px;
}
#controls button {
  font-size: 40px;
  width: 80px;
  height: 80px;
  border-radius: 50%;
  border: none;
  background: white;
  color: #2e7d32;
  box-shadow: 0 5px #ccc;
  cursor: pointer;
}
.restart-btn {
  margin-top: 15px;
  font-size: 20px;
  padding: 12px 30px;
  border-radius: 50px;
  border: none;
  background: #ff5252;
  color: white;
  cursor: pointer;
}
</style>
</head>
<body>

<h2 style="color: #0277bd;">üçé Newton's Gravity Enhanced üçé</h2>
<canvas id="game" width="520" height="620"></canvas>

<div id="mobile-ui">
  <div id="controls">
    <button id="leftBtn">‚óÄ</button>
    <button id="rightBtn">‚ñ∂</button>
  </div>
  <button class="restart-btn" onclick="restartGame()">Restart Game</button>
</div>

<audio id="bgm" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_0f7c38a88e.mp3?filename=peaceful-garden-12257.mp3">
</audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const music = document.getElementById("bgm");

// --- IMAGE LOADING ---
const newtonImg = new Image();
// REPLACE THE URL BELOW WITH YOUR CUSTOM PIC LINK OR FILENAME
newtonImg.src = 'https://i.imgur.com/your_image_here.png'; 

// --- VARIABLES ---
let newtonX = 215;
let appleX = Math.random() * 480;
let appleY = 0;
let score = 0;
let speed = 5;
let gameOver = false;
let isGolden = false;

// --- GENERATE TEXTURES ---
const grassTexture = document.createElement("canvas");
grassTexture.width = 520; grassTexture.height = 180;
const gCtx = grassTexture.getContext("2d");
gCtx.fillStyle = "#4caf50";
gCtx.fillRect(0,0,520,180);
for(let i=0; i<1500; i++){
    gCtx.strokeStyle = ["#2e7d32", "#388e3c", "#81c784"][Math.floor(Math.random()*3)];
    let x = Math.random() * 520;
    let h = 10 + Math.random() * 20;
    gCtx.beginPath();
    gCtx.moveTo(x, 180);
    gCtx.lineTo(x + (Math.random()*6-3), 180-h);
    gCtx.stroke();
}

// --- CONTROLS ---
document.addEventListener("keydown", (e) => {
    if(e.key==="ArrowLeft" && newtonX > 10) newtonX -= 40;
    if(e.key==="ArrowRight" && newtonX < 410) newtonX += 40;
});
document.getElementById("leftBtn").onclick = () => { if(newtonX>20) newtonX-=50; };
document.getElementById("rightBtn").onclick = () => { if(newtonX<410) newtonX+=50; };

// --- DRAW FUNCTIONS ---
function drawNewton() {
    // Soft shadow
    ctx.fillStyle = "rgba(0,0,0,0.15)";
    ctx.beginPath(); ctx.ellipse(newtonX+50, 580, 40, 10, 0, 0, Math.PI*2); ctx.fill();

    // DRAW THE CUSTOM IMAGE
    // (x, y, width, height)
    ctx.drawImage(newtonImg, newtonX, 440, 100, 140);
}

function drawApple() {
    ctx.shadowBlur = 10;
    ctx.shadowColor = isGolden ? "gold" : "red";
    ctx.fillStyle = isGolden ? "#ffd700" : "#ff1744";
    ctx.beginPath(); ctx.arc(appleX, appleY, 18, 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0; // Reset shadow
}

function resetApple() {
    appleY = -20;
    appleX = 40 + Math.random() * 440;
    isGolden = Math.random() < 0.2;
}

function restartGame() {
    score = 0; speed = 5; gameOver = false;
    resetApple();
    music.play();
    gameLoop();
}

function gameLoop() {
    if(gameOver) {
        ctx.fillStyle = "rgba(0,0,0,0.6)"; ctx.fillRect(0,0,520,620);
        ctx.fillStyle = "white"; ctx.font = "bold 40px Arial";
        ctx.textAlign = "center";
        ctx.fillText("GAME OVER", 260, 300);
        return;
    }

    ctx.clearRect(0,0,520,620);
    ctx.drawImage(grassTexture, 0, 440);
    drawNewton();
    drawApple();

    // UI
    ctx.fillStyle = "white"; ctx.font = "20px Arial"; ctx.textAlign = "left";
    ctx.fillText("Score: " + score, 30, 40);

    appleY += speed;

    // Collision
    if(appleY > 450 && appleY < 560 && appleX > newtonX && appleX < newtonX + 100) {
        score += isGolden ? 5 : 1;
        if(score % 5 === 0) speed += 0.5;
        resetApple();
    }

    if(appleY > 620) { gameOver = true; music.pause(); }

    requestAnimationFrame(gameLoop);
}

// Start
newtonImg.onload = () => { gameLoop(); }; 
resetApple();
</script>
</body>
</html>
